var Ee=Object.defineProperty;var he=o=>{throw TypeError(o)};var ye=(o,t,e)=>t in o?Ee(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var u=(o,t,e)=>ye(o,typeof t!="symbol"?t+"":t,e),ce=(o,t,e)=>t.has(o)||he("Cannot "+e);var i=(o,t,e)=>(ce(o,t,"read from private field"),e?e.call(o):t.get(o)),h=(o,t,e)=>t.has(o)?he("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(o):t.set(o,e),d=(o,t,e,s)=>(ce(o,t,"write to private field"),s?s.call(o,e):t.set(o,e),e),de=(o,t,e)=>(ce(o,t,"access private method"),e);var ue=(o,t,e,s)=>({set _(n){d(o,t,n,e)},get _(){return i(o,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}})();var L;class Fe{constructor(){h(this,L,{})}getFreeSubscribeID(t){if(!Object.hasOwn(i(this,L),t))return-1;let e=-1;return Object.keys(i(this,L)[t]).forEach(s=>{s>e&&(e=s)}),e+1}connect(t,e,s=!1){Object.hasOwn(i(this,L),t)||(i(this,L)[t]={}),Object.values(i(this,L)[t]).forEach(a=>{a.callback});const n=this.getFreeSubscribeID(t);i(this,L)[t][n]={callback:e,once:s}}disconnect(t,e){if(Object.hasOwn(i(this,L),t)){for(const[s,n]of Object.entries(i(this,L)[t]))if(n.callback===e){delete i(this,L)[t][s];return}}}emit(t,...e){if(!Object.hasOwn(i(this,L),t))return;const s=[];for(const[n,a]of Object.entries(i(this,L)[t]))a.once&&s.push(n),a.callback(...e);s.forEach(n=>{delete i(this,L)[t][n]})}}L=new WeakMap;var F;class B extends Fe{constructor(){super(...arguments);u(this,"element");h(this,F,{})}static createElement(e){return document.createElement(e)}getFreeEventListenerID(){let e=-1;return Object.keys(i(this,F)).forEach(s=>{s>e&&(e=s)}),e+1}hasEventListener(e,s){return Object.keys(i(this,F)).forEach(n=>{const a=i(this,F)[n];if(a.eventType===e&&a.callback===s)return!0}),!1}getEventListenerID(e,s){return Object.keys(i(this,F)).forEach(n=>{const a=i(this,F)[n];if(a.eventType===e&&a.callback===s)return n}),-1}addEventListener(e,s){if(this.hasEventListener(e,s))throw Error("Multiple addition of eventListener is not allowed");i(this,F)[this.getFreeEventListenerID()]={eventType:e,callback:s,enabled:!0},this.element.addEventListener(e,s)}removeEventListener(e,s){const n=this.getEventListenerID(e,s);n!==-1&&(delete i(this,F)[n],this.element.removeEventListener(e,s))}switchEventListeners(e=!1,s=()=>!0){Object.values(i(this,F)).forEach(n=>{if(s(n.eventType,n.callback,n.enabled)){if(n.enabled===e)return;e?this.element.addEventListener(n.eventType,n.callback):this.element.removeEventListener(n.eventType,n.callback)}})}destroy(){this.element.replaceWith(),delete this}}F=new WeakMap;const Se="data:image/svg+xml,%3csvg%20width='800'%20height='800'%20viewBox='0%200%20800%20800'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M666.667%20666.667L133.333%20133.334M666.667%20133.333L133.334%20666.667'%20stroke='%232C2D2D'%20stroke-width='66.6667'%20stroke-linecap='round'/%3e%3c/svg%3e";var P,fe,Ce;class se extends B{constructor(){super();h(this,P);this.element=this.constructor.createElement(this),this.addEventListener("click",de(this,P,fe).bind(this)),this.addEventListener("click",de(this,P,Ce).bind(this))}static createElement(){const e=document.createElement("div");e.classList.add("modal-window");const s=document.createElement("div");s.classList.add("modal-window__container");const n=document.createElement("img");return n.src=Se,n.alt="Close icon",n.classList.add("modal-window__close-icon"),s.append(n),e.append(s),e}closeWindow(){this.destroy()}}P=new WeakSet,fe=function(e){e.target.classList.contains("modal-window")&&this.closeWindow()},Ce=function(e){e.target.classList.contains("modal-window__close-icon")&&this.closeWindow()};class Be extends B{constructor(t=0){super(),this.element=this.constructor.createElement(t)}static createElement(t=0){const e=new se,s=e.element.firstElementChild,n=document.createElement("p");return n.classList.add("congratulations","paragraph"),n.textContent=`Great! You have solved the nonogram in ${t} seconds!`,s.append(n),e.element}}const g={gameStarted:!1,gameFinished:!1,muted:!1},xe="/assets/click-DCxTwWhi.wav",_e="/assets/cross-DbYRd3sF.wav",Ge="/assets/press-button-BTFerGXG.wav",ke="/assets/win-CBZc-zpZ.wav",De="/assets/solution-BFM6zFDD.wav",j={click:new Audio(xe),cross:new Audio(_e),pressButton:new Audio(Ge),win:new Audio(ke),solution:new Audio(De)};class y extends B{constructor(t={}){super(),this.element=this.constructor.createElement(t),this.updateContent(t),this.addEventListener("click",this.constructor.playPressSound),this.onClick=this.onClick.bind(this),this.addEventListener("click",this.onClick)}static createElement(t={}){const e=document.createElement("button");return e.classList.add("button"),y.updateContent(e,t),e}static updateContent(t,e){for(const[s,n]of Object.entries(e))s==="text"?(t.textContent=n,t.classList.add("button-text")):s==="icon"?(t.style.backgroundImage=`url("${n}")`,t.classList.add("button-icon")):s==="disabled"&&(t.element.disabled=n)}static playPressSound(){g.muted||j.pressButton.play()}updateContent(t){this.constructor.updateContent(this.element,t)}onClick(){this.emit("press")}}const Te="data:image/svg+xml,%3csvg%20width='800'%20height='800'%20viewBox='0%200%20800%20800'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M466.667%20108.953C466.667%2085.599%20447.733%2066.6666%20424.38%2066.6666H375.62C352.267%2066.6666%20333.333%2085.599%20333.333%20108.953C333.333%20128.248%20320.122%20144.767%20302.173%20151.849C299.333%20152.969%20296.516%20154.138%20293.724%20155.352C276.023%20163.052%20254.992%20160.715%20241.342%20147.066C224.825%20130.548%20198.044%20130.548%20181.526%20147.066L147.062%20181.529C130.544%20198.048%20130.544%20224.829%20147.062%20241.347C160.712%20254.997%20163.049%20276.029%20155.35%20293.73C154.136%20296.52%20152.969%20299.335%20151.849%20302.173C144.767%20320.122%20128.248%20333.333%20108.953%20333.333C85.5991%20333.333%2066.6667%20352.267%2066.6667%20375.62V424.38C66.6667%20447.733%2085.5991%20466.667%20108.953%20466.667C128.248%20466.667%20144.767%20479.877%20151.849%20497.827C152.969%20500.667%20154.136%20503.48%20155.35%20506.27C163.049%20523.97%20160.712%20545.003%20147.062%20558.653C130.544%20575.17%20130.544%20601.953%20147.062%20618.47L181.526%20652.933C198.044%20669.453%20224.825%20669.453%20241.343%20652.933C254.992%20639.287%20276.024%20636.947%20293.724%20644.647C296.516%20645.863%20299.333%20647.03%20302.173%20648.15C320.122%20655.233%20333.333%20671.753%20333.333%20691.047C333.333%20714.4%20352.267%20733.333%20375.62%20733.333H424.38C447.733%20733.333%20466.667%20714.4%20466.667%20691.047C466.667%20671.753%20479.877%20655.233%20497.827%20648.15C500.667%20647.03%20503.483%20645.863%20506.273%20644.65C523.973%20636.95%20545.003%20639.287%20558.65%20652.937C575.167%20669.453%20601.947%20669.453%20618.463%20652.937L652.933%20618.467C669.45%20601.95%20669.45%20575.173%20652.933%20558.657C639.283%20545.007%20636.947%20523.977%20644.647%20506.277C645.863%20503.487%20647.03%20500.667%20648.15%20497.827C655.233%20479.88%20671.753%20466.667%20691.047%20466.667C714.4%20466.667%20733.333%20447.733%20733.333%20424.38V375.62C733.333%20352.267%20714.4%20333.333%20691.047%20333.333C671.753%20333.333%20655.233%20320.122%20648.15%20302.173C647.03%20299.332%20645.863%20296.515%20644.647%20293.722C636.947%20276.023%20639.283%20254.992%20652.933%20241.344C669.45%20224.828%20669.45%20198.049%20652.933%20181.532L618.463%20147.064C601.947%20130.547%20575.167%20130.547%20558.65%20147.064C545.003%20160.713%20523.973%20163.05%20506.273%20155.351C503.483%20154.137%20500.667%20152.969%20497.827%20151.849C479.877%20144.767%20466.667%20128.248%20466.667%20108.953Z'%20stroke='%232C2D2D'%20stroke-width='66.6667'/%3e%3cpath%20d='M533.333%20400C533.333%20473.637%20473.637%20533.333%20400%20533.333C326.362%20533.333%20266.667%20473.637%20266.667%20400C266.667%20326.362%20326.362%20266.667%20400%20266.667C473.637%20266.667%20533.333%20326.362%20533.333%20400Z'%20stroke='%232C2D2D'%20stroke-width='66.6667'/%3e%3c/svg%3e",we="data:image/svg+xml,%3csvg%20width='800'%20height='800'%20viewBox='0%200%20800%20800'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M66.6667%20498.627V301.374C66.6667%20282.206%2081.5907%20266.667%20100%20266.667H219.526C228.367%20266.667%20236.845%20263.01%20243.096%20256.501L343.097%20143.569C364.097%20121.704%20400%20137.189%20400%20168.111V631.89C400%20663.027%20363.667%20678.413%20342.797%20656.113L243.146%20543.817C236.872%20537.113%20228.264%20533.333%20219.275%20533.333H100C81.5907%20533.333%2066.6667%20517.793%2066.6667%20498.627Z'%20stroke='%232C2D2D'%20stroke-width='66.6667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M533.333%20283.333C577.777%20342.593%20577.777%20457.407%20533.333%20516.667'%20stroke='%232C2D2D'%20stroke-width='66.6667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M633.333%20166.667C766.263%20293.612%20767.07%20507.237%20633.333%20633.333'%20stroke='%232C2D2D'%20stroke-width='66.6667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";var x,G;const te=class te extends B{constructor(e=0){super();h(this,x);h(this,G);d(this,x,e),this.element=this.constructor.createElement(e)}static createElement(e=0){const s=document.createElement("p");return s.classList.add("control-panel__game-duration","paragraph"),s.textContent=te.getFormattedTime(e),s}static getFormattedTime(e){return`${Math.floor(e/60)}`.padStart(2,"0")+":"+`${e%60}`.padStart(2,"0")}get seconds(){return i(this,x)}start(){i(this,G)===void 0&&d(this,G,setInterval(()=>{d(this,x,i(this,x)+1),this.element.textContent=this.constructor.getFormattedTime(i(this,x))},1e3))}stop(){i(this,G)!==void 0&&(clearInterval(i(this,G)),d(this,G,void 0))}setTime(e){i(this,G)!==void 0?(this.stop(),d(this,x,e),this.start()):d(this,x,e),this.element.textContent=te.getFormattedTime(e)}clear(){d(this,x,0),this.element.textContent=this.constructor.getFormattedTime(0)}};x=new WeakMap,G=new WeakMap;let ee=te;const Pe="data:image/svg+xml,%3csvg%20width='800'%20height='800'%20viewBox='0%200%20800%20800'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M733.333%20500L533.333%20300M733.333%20300L533.333%20500'%20stroke='%232C2D2D'%20stroke-width='66.6667'%20stroke-linecap='round'/%3e%3cpath%20d='M66.6667%20498.627V301.374C66.6667%20282.206%2081.5907%20266.667%20100%20266.667H219.526C228.367%20266.667%20236.845%20263.01%20243.096%20256.501L343.097%20143.569C364.097%20121.704%20400%20137.189%20400%20168.111V631.89C400%20663.027%20363.667%20678.413%20342.797%20656.113L243.146%20543.817C236.872%20537.113%20228.264%20533.333%20219.275%20533.333H100C81.5907%20533.333%2066.6667%20517.793%2066.6667%20498.627Z'%20stroke='%232C2D2D'%20stroke-width='66.6667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";class Oe extends y{constructor(e=!0){super();u(this,"soundOn");this.soundOn=e,this.switchSound(e)}switchSound(e=!0){this.soundOn=e,e?this.updateContent({icon:we}):this.updateContent({icon:Pe}),this.emit("press")}onClick(){this.switchSound(!this.soundOn)}}var z,N,$;class ge{constructor(t,e,s){h(this,z);h(this,N);h(this,$);d(this,z,t),d(this,N,e),d(this,$,s)}get name(){return i(this,z)}get className(){return i(this,N)}get icon(){return i(this,$)}}z=new WeakMap,N=new WeakMap,$=new WeakMap;const We="/assets/sun-DhpbJFR_.svg",je="data:image/svg+xml,%3csvg%20width='800'%20height='800'%20viewBox='0%200%20800%20800'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M110.677%20389.45C110.677%20555.137%20244.992%20689.45%20410.677%20689.45C536.917%20689.45%20644.943%20611.477%20689.227%20501.067C654.673%20514.953%20616.863%20522.78%20577.343%20522.78C411.657%20522.78%20277.344%20388.467%20277.344%20222.781C277.344%20183.446%20285.055%20145.42%20298.818%20110.999C188.535%20155.343%20110.677%20263.304%20110.677%20389.45Z'%20stroke='%232C2D2D'%20stroke-width='66.6667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",T={day:new ge("day","theme-day",We),night:new ge("night","theme-night",je)};class Me extends y{constructor(e=T.day){super();u(this,"theme");this.theme=e,this.switchTheme(e)}switchTheme(e){this.theme=e;const s=Object.values(T).map(n=>n.className);document.body.classList.forEach(n=>{s.includes(n)&&document.body.classList.remove(n)}),document.body.classList.add(e.className),this.updateContent({icon:e.icon})}onClick(){this.theme===T.day?this.switchTheme(T.night):this.switchTheme(T.day),this.emit("press")}}class Ie extends B{constructor(){super();u(this,"gameTimer");u(this,"optionsButton");u(this,"soundButton");u(this,"themeButton");[this.element,this.gameTimer,this.optionsButton,this.soundButton,this.themeButton]=this.constructor.createElement()}static createElement(){const e=document.createElement("div");e.classList.add("control-panel");const s=document.createElement("div");s.classList.add("control-panel__buttons");const n=new y({icon:Te}),a=new Oe({icon:we}),l=new Me(T.night);s.append(n.element,a.element,l.element);const c=new ee;return e.append(s,c.element),[e,c,n,a,l]}}class M extends B{constructor(){super(),this.element=this.constructor.createElement()}static createElement(){const t=document.createElement("div");return t.classList.add("game-field__cell"),t}}class ze extends M{static createElement(){const t=M.createElement();return t.classList.add("game-field__cell-empty"),t}}class pe extends M{static createElement(){const t=M.createElement();return t.classList.add("game-field__cell-clue"),t}}class W{constructor(t){u(this,"name");this.name=t}static compareGameCellState(t,e){return t.name===e.name}apply(t){let e=!1;t.element.classList.forEach(s=>{s.startsWith("game-field__cell-game_")&&(e=!0,t.element.classList.replace(s,"game-field__cell-game_"+this.name))}),e||t.element.classList.add("game-field__cell-game_"+this.name)}}const _={empty:new W("empty"),crossed:new W("crossed"),filled:new W("filled")};var H;class Ne extends M{constructor(e=_.empty,s=!1){super();h(this,H,!1);u(this,"currentGameCellState");this.onClick=this.onClick.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.currentGameCellState=e,s||this.addEventListener("click",this.onClick),s||this.addEventListener("contextmenu",this.onContextMenu)}static createElement(){const e=super.createElement();return e.classList.add("game-field__cell-game"),e}get disabled(){return i(this,H)}set disabled(e){d(this,H,e),e===!0?(this.removeEventListener("click",this.onClick),this.removeEventListener("contextMenu",this.onContextMenu)):this.hasEventListener("click",this.onClick)||(this.addEventListener("click",this.onClick),this.addEventListener("contextMenu",this.onContextMenu))}onClick(){W.compareGameCellState(this.currentGameCellState,_.filled)?this.currentGameCellState=_.empty:this.currentGameCellState=_.filled,this.currentGameCellState.apply(this),g.muted||j.click.play(),this.emit("game-cell-state-changed")}onContextMenu(e){W.compareGameCellState(this.currentGameCellState,_.crossed)?this.currentGameCellState=_.empty:this.currentGameCellState=_.crossed,this.currentGameCellState.apply(this),e.preventDefault(),g.muted||j.cross.play(),this.emit("game-cell-state-changed")}}H=new WeakMap;function $e(o){const t=[],e=o.length,s=o[0].length;for(let n=0;n<s;n++){t[n]=new Array(e);for(let a=0;a<e;a++)t[n][a]=o[a][n]}return t}var V,R,A,Z,J,q;const me=class me{constructor(t,e){h(this,V);h(this,R);h(this,A);h(this,Z);h(this,J);h(this,q);d(this,V,t),d(this,R,e[0].length),d(this,A,e.length),d(this,Z,this.constructor.getTopClues(e)),d(this,J,this.constructor.getLeftClues(e)),d(this,q,this.constructor.getData(e))}static getTopClues(t){return $e(t).reduce((s,n,a)=>{let l=0;return n.forEach(c=>{c===1?l===0?(l=1,s[a].push(1)):s[a][s[a].length-1]+=1:l=0}),s},Array.from({length:t[0].length},()=>[]))}static getLeftClues(t){return t.reduce((e,s,n)=>{let a=0;return s.forEach(l=>{l===1?a===0?(a=1,e[n].push(1)):e[n][e[n].length-1]+=1:a=0}),e},Array.from({length:t.length},()=>[]))}static getData(t){return t.flat()}static compareFramesData(t,e){return t.length!==e.length?!1:t.every((s,n)=>s===e[n])}static getFrameFromData(t,e,s){const n=t.reduce((a,l,c)=>(c%e===0&&a.push([]),a[Math.floor(c/e)].push(l),a),[]);return new me(s,n)}get name(){return i(this,V)}get width(){return i(this,R)}get height(){return i(this,A)}get topClues(){return i(this,Z)}get leftClues(){return i(this,J)}get data(){return i(this,q)}};V=new WeakMap,R=new WeakMap,A=new WeakMap,Z=new WeakMap,J=new WeakMap,q=new WeakMap;let I=me;var Y,D,k;class O extends B{constructor(e,s){super();h(this,Y);h(this,D);h(this,k);d(this,Y,e),d(this,D,s),[this.element,ue(this,k)._]=this.constructor.createElement(e,s),i(this,k).forEach(n=>{n.connect("game-cell-state-changed",this.onGameCellChanged.bind(this))})}static createElement(e,s){const n=document.createElement("div");n.classList.add("game-field",e.style);const a=[],l=new ze;this.data=[[l]],n.append(l.element);const c=[];for(let r=1;r<e.size+1;r+=1){const C=new pe;s.topClues[r-1].forEach(f=>{const m=document.createElement("span");m.classList.add("game-field__clue"),m.textContent=f,C.element.append(m)}),this.data[0].push(C);const b=Math.floor((r-1)/5);(r-1)%5===0&&(c[b]=document.createElement("div"),c[b].classList.add("subgrid-5x1")),c[b].append(C.element)}c.forEach(r=>n.append(r));const p=[],w=[];let v=-1;for(let r=1;r<e.size+1;r+=1){const C=new pe;s.leftClues[r-1].forEach(f=>{const m=document.createElement("span");m.classList.add("game-field__clue"),m.textContent=f,C.element.append(m)}),this.data.push([C]);const b=Math.floor((r-1)/5);(r-1)%5===0&&(p[b]=document.createElement("div")),p[b].append(C.element);for(let f=1;f<e.size+1;f+=1){const m=new Ne;this.data[r].push(m);let E=Math.floor((f-1)/5);(r-1)%5===0&&(f-1)%5===0&&(f===1&&(v+=1),w[E+v*e.size/5]=document.createElement("div")),w[E+v*e.size/5].append(m.element),a.push(m)}}for(let r=0;r<p.length+w.length;r+=1){const C=Math.floor(r/(e.size/5+1));if(r%(e.size/5+1)===0){const b=p[C];b.classList.add("subgrid-1x5"),n.append(b)}else{const b=w[r-(C+1)];b.classList.add("subgrid-5x5"),n.append(b)}}return[n,a]}parseFrameData(){return i(this,k).map(e=>e.element.classList.contains("game-field__cell-game_filled")===!0?1:0)}get level(){return i(this,Y)}get frame(){return i(this,D)}switchGameCells(e=!0){i(this,k).forEach(s=>{s.switchEventListeners(e,()=>!0)})}checkFrames(){console.log("checked!");const e=this.parseFrameData();console.log(i(this,D).data,e),I.compareFramesData(i(this,D).data,e)&&this.emit("game-win")}updateContent(e){i(this,k).forEach((s,n)=>{s.currentGameCellState=e.data[n]===1?_.filled:_.empty,s.currentGameCellState.apply(s)})}onGameCellChanged(){this.emit("game-cell-changed"),this.checkFrames()}}Y=new WeakMap,D=new WeakMap,k=new WeakMap;class He extends y{constructor(){super({text:"Solution"})}static playPressSound(){g.muted||j.solution.play()}onClick(){this.emit("press")}}class Ve extends B{constructor(){super();u(this,"resetGameButton");u(this,"levelsButton");u(this,"continueLastGameButton");u(this,"saveGameButton");u(this,"highScoreTableButton");u(this,"randomLevelButton");[this.element,this.resetGameButton,this.levelsButton,this.continueLastGameButton,this.saveGameButton,this.highScoreTableButton,this.randomLevelButton]=this.constructor.createElement()}static createElement(){const e=new se,s=e.element.firstElementChild;s.classList.add("options");const n=document.createElement("h1");n.classList.add("header-2"),n.classList.add("options__header"),n.textContent="Nonograms";const a=document.createElement("div");a.classList.add("options__buttons");const l=new y({text:"Reset Game"});l.element.classList.add("options__button");const c=new y({text:"Levels"});c.element.classList.add("options__button");const p=new y({text:"Continue Last Game"});p.element.classList.add("options__button");const w=new y({text:"Save Game"});w.element.classList.add("options__button");const v=new y({text:"High Score Table"});v.element.classList.add("options__button");const r=new y({text:"Random Level"});return r.element.classList.add("options__button"),a.append(l.element,c.element,p.element,w.element,v.element,r.element),s.append(n,a),[e.element,l,c,p,w,v,r]}}function ve(o,t){return Math.floor(Math.random()*(t-o)+o)}var K,X,Q,U;class Re{constructor(t,e,s,n){h(this,K);h(this,X);h(this,Q);h(this,U);d(this,K,t),d(this,X,e),d(this,Q,s),d(this,U,n)}get name(){return i(this,K)}get size(){return i(this,X)}get style(){return i(this,Q)}get frames(){return i(this,U)}}K=new WeakMap,X=new WeakMap,Q=new WeakMap,U=new WeakMap;const Ae="easy",Ze={width:5,height:5},Je={heart:[[0,1,0,1,0],[1,1,1,1,1],[1,1,1,1,1],[0,1,1,1,0],[0,0,1,0,0]],flowers:[[0,1,0,0,0],[1,1,1,0,0],[0,1,0,1,0],[0,0,1,1,1],[0,0,0,1,0]],pick:[[0,1,1,1,0],[1,0,1,0,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]],ghost:[[0,1,1,1,0],[1,0,1,0,1],[1,1,1,1,1],[1,1,1,1,1],[1,0,1,0,1]],crab:[[0,1,0,1,0],[1,1,0,1,1],[0,1,1,1,0],[0,1,1,1,0],[1,0,0,0,1]]},qe={name:Ae,size:Ze,frames:Je},Ye="medium",Ke={width:10,height:10},Xe={what:[[0,0,1,1,1,1,1,1,0,0],[0,1,1,0,0,0,0,1,1,0],[0,1,1,0,0,0,0,1,1,0],[0,0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,1,1,1,0],[0,0,0,0,1,1,1,1,0,0],[0,0,0,0,1,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,1,0,0,0,0],[0,0,0,0,1,1,0,0,0,0]],music:[[0,0,0,0,0,0,1,1,1,1],[0,0,0,1,1,1,0,0,0,1],[0,0,0,1,0,0,0,1,1,1],[0,0,0,1,1,1,1,0,0,1],[0,0,0,1,0,0,0,0,0,1],[0,0,0,1,0,0,0,1,1,1],[0,1,1,1,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1],[1,1,1,1,0,0,0,0,1,0],[0,1,1,0,0,0,0,0,0,0]],cuppa:[[0,0,1,0,1,0,1,0,0,0],[0,0,1,0,1,0,1,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,0,0],[0,1,1,0,1,1,1,1,1,1],[0,1,1,0,1,1,1,1,0,1],[0,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,0,0],[1,0,1,1,1,1,1,0,0,1],[0,1,1,1,1,1,1,1,1,0]],cherries:[[0,0,0,0,1,1,1,0,0,0],[0,0,1,1,1,1,0,1,0,0],[0,1,0,1,0,1,1,0,1,0],[1,1,1,0,0,1,0,1,1,1],[0,0,0,0,0,1,0,0,0,0],[0,0,1,1,1,0,1,1,1,0],[0,1,1,1,1,1,0,1,1,1],[0,1,1,1,0,1,0,1,0,1],[0,1,1,1,1,1,0,1,1,1],[0,0,1,1,1,0,1,1,1,0]],"wake-up":[[0,1,1,0,0,0,0,1,1,0],[1,1,0,1,1,1,1,0,1,1],[1,0,1,1,1,0,1,1,0,1],[0,1,1,1,1,0,1,1,1,0],[0,1,1,1,1,0,1,1,1,0],[0,1,1,1,0,1,1,1,1,0],[0,1,1,0,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,0,0],[0,0,0,1,1,1,1,0,0,0],[0,0,1,1,0,0,1,1,0,0]]},Qe={name:Ye,size:Ke,frames:Xe},Ue="hard",et={width:15,height:15},tt={deer:[[1,1,0,1,1,0,0,0,0,0,0,1,1,0,1],[1,1,0,1,1,0,1,0,0,1,0,1,1,0,1],[0,1,1,1,1,0,1,0,0,1,0,1,1,0,1],[0,0,1,1,1,1,1,0,0,0,1,1,1,1,1],[0,0,0,0,1,1,0,1,1,1,1,1,0,0,0],[0,0,0,0,0,0,1,1,1,1,1,1,1,0,0],[0,0,0,0,0,1,0,1,0,1,1,1,1,1,0],[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,0,1,1,1,1,0,0,0,1,1,1,1,1],[0,1,1,1,1,1,1,0,0,0,1,1,1,1,1],[0,0,1,1,1,1,0,0,0,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,1,1,1,1,1,1]],skittles:[[0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,1,1,0,1,0],[0,0,0,0,0,0,0,0,0,0,1,1,1,1,0],[0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,1,1,1,1,0],[0,0,0,0,0,0,0,0,0,0,1,1,0,1,0],[0,0,0,0,0,0,0,0,0,1,1,1,1,0,1],[0,0,0,0,0,0,0,0,0,1,1,1,1,1,0],[0,1,1,1,0,0,0,0,1,1,1,1,1,1,1],[1,1,1,0,1,0,0,0,1,1,1,1,1,1,1],[1,1,1,0,1,0,0,0,0,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,1,1,1,1,1,1],[0,1,1,1,0,0,0,0,0,0,1,1,1,1,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],clover:[[0,0,0,0,0,1,1,0,1,1,0,0,0,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0],[0,1,1,1,0,1,1,1,1,1,0,1,1,1,0],[1,1,1,1,1,0,1,1,1,0,1,1,1,1,1],[1,1,1,1,1,1,0,1,0,1,1,1,1,1,1],[0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],[1,1,1,1,1,1,0,1,0,1,1,1,1,1,1],[1,1,1,1,1,0,0,1,0,0,1,1,1,1,1],[0,1,1,1,0,0,0,1,0,0,0,1,1,1,0],[0,0,0,0,0,0,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,1,1,0,0,0,0,0,0,0,0],[0,0,1,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,1,1,0,0,0,0,0,0,0,0,0,0,0]],sun:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,0,1,1,1,1,0,1,1,1,1,0,1,1],[1,1,1,0,1,1,1,1,1,1,1,0,1,1,1],[1,1,1,1,1,0,0,0,0,0,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,1,0,1,0,0,1,1,1,1],[1,0,0,1,0,0,0,0,0,0,0,1,0,0,1],[1,1,1,1,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,0,0,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,1,1,1,1,1],[1,1,1,0,1,1,1,1,1,1,1,0,1,1,1],[1,1,0,1,1,1,1,0,1,1,1,1,0,1,1],[1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],castle:[[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[1,1,0,1,1,0,1,0,0,0,1,1,0,1,1],[1,1,1,1,1,0,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,0,1,0,0,0,1,0,0,0,1],[1,0,1,0,1,0,1,0,0,0,1,0,1,0,1],[1,0,1,0,1,1,1,1,1,1,1,0,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,1,0,0,0,0,0,0,0,1,0,0,1],[1,0,1,1,1,0,0,1,0,0,1,1,1,0,1],[1,0,0,1,0,0,1,1,1,0,0,1,0,0,1],[1,0,0,1,0,0,1,1,1,0,0,1,0,0,1],[1,0,0,0,0,0,1,1,1,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]},st={name:Ue,size:et,frames:tt},nt={easy:qe,medium:Qe,hard:st},S={};for(const[o,t]of Object.entries(nt)){const e=`${t.size.width}x${t.size.height}`,s={};for(const[n,a]of Object.entries(t.frames))s[n]=new I(n,a);S[o]=new Re(`${t.name} ${e}`,t.size.width,`grid-template-${e}`,s)}function at(){return S[Object.keys(S)[ve(0,Object.keys(S).length)]]}function be(o){return o.frames[Object.keys(o.frames)[ve(0,Object.keys(o.frames).length)]]}const ot="data:image/svg+xml,%3csvg%20width='800'%20height='800'%20viewBox='0%200%20800%20800'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M567.874%20238.021C568.096%20255.251%20565.986%20272.431%20561.6%20289.095C557.792%20303.153%20552.292%20316.698%20545.221%20329.432C538.74%20340.937%20531.228%20351.831%20522.779%20361.979C514.568%20371.789%20506.526%20381.095%20498.863%20389.684L497.853%20390.779C490.695%20398.358%20484.042%20405.642%20478.147%20412.505C471.777%20419.902%20466.137%20427.897%20461.305%20436.379C456.245%20445.343%20452.368%20454.924%20449.768%20464.884C446.837%20476.698%20445.436%20488.84%20445.6%20501.011V503.116C445.108%20514.276%20440.328%20524.816%20432.257%20532.54C424.185%20540.263%20413.445%20544.574%20402.274%20544.574C391.102%20544.574%20380.362%20540.263%20372.291%20532.54C364.219%20524.816%20359.44%20514.276%20358.947%20503.116V501.011C358.773%20481.35%20361.136%20461.75%20365.979%20442.695C370.489%20425.485%20377.196%20408.928%20385.937%20393.432C393.564%20380.123%20402.447%20367.575%20412.463%20355.958C419.116%20348.211%20426.568%20339.958%20434.568%20331.579C441.558%20323.705%20448.884%20315.158%20456.463%20306.189C461.522%20300.097%20466.018%20293.558%20469.895%20286.653C473.466%20280.059%20476.236%20273.062%20478.147%20265.811C480.42%20256.728%20481.454%20247.38%20481.221%20238.021C481.398%20227.013%20479.291%20216.089%20475.032%20205.937C470.997%20195.99%20465.045%20186.934%20457.516%20179.284C450.054%20171.761%20441.183%20165.78%20431.411%20161.684C421.806%20157.534%20411.43%20155.468%20400.968%20155.621C390.183%20155.44%20379.48%20157.535%20369.558%20161.768C349.341%20170.168%20333.287%20186.252%20324.926%20206.484C320.699%20216.423%20318.605%20227.138%20318.779%20237.937V239.116C319.037%20244.966%20318.107%20250.808%20316.046%20256.29C313.985%20261.771%20310.836%20266.778%20306.787%20271.009C302.738%20275.24%20297.875%20278.608%20292.489%20280.908C287.104%20283.209%20281.309%20284.395%20275.453%20284.395C269.597%20284.395%20263.801%20283.209%20258.416%20280.908C253.031%20278.608%20248.167%20275.24%20244.118%20271.009C240.07%20266.778%20236.92%20261.771%20234.859%20256.29C232.798%20250.808%20231.868%20244.966%20232.126%20239.116V237.937C231.95%20215.364%20236.452%20193%20245.347%20172.253C262.446%20131.674%20294.696%2099.3642%20335.242%2082.1895C355.996%2073.2696%20378.38%2068.7671%20400.968%2068.9684C423.311%2068.781%20445.444%2073.2851%20465.937%2082.1895C506.217%2099.4033%20538.144%20131.723%20554.863%20172.211C563.659%20193.027%20568.059%20215.423%20567.874%20238.021ZM452.589%20651.074C455.474%20657.961%20456.96%20665.354%20456.96%20672.821C456.96%20680.288%20455.474%20687.681%20452.589%20694.568C446.883%20708.036%20436.163%20718.757%20422.695%20724.463L422.484%20724.589C415.765%20727.464%20408.53%20728.94%20401.221%20728.926C390.07%20729.026%20379.14%20725.815%20369.816%20719.699C360.492%20713.582%20353.192%20704.836%20348.842%20694.568C344.469%20684.362%20343.271%20673.075%20345.404%20662.178C347.537%20651.281%20352.902%20641.279%20360.8%20633.474C366.094%20628.396%20372.292%20624.355%20379.074%20621.558C386.085%20618.613%20393.617%20617.11%20401.221%20617.137C408.529%20617.13%20415.762%20618.606%20422.484%20621.474L422.695%20621.6C429.331%20624.42%20435.396%20628.429%20440.589%20633.432C445.721%20638.441%20449.8%20644.425%20452.589%20651.032V651.074Z'%20fill='%232C2D2D'/%3e%3c/svg%3e";class it extends B{constructor(e){super();u(this,"levelsView");[this.element,this.levelsView]=this.constructor.createElement(e);for(const[s,n]of Object.entries(this.levelsView))for(const[a,l]of Object.entries(n))l.onPress=()=>this.onPressFrameButton.bind(l,s,a),l.connect("press",()=>{this.emit("press-frame-button",s,a)})}static createElement(e){const s=new se,n=s.element.firstElementChild;n.classList.add("levels");const a=document.createElement("h2");a.classList.add("header-2"),a.classList.add("levels__header"),a.textContent="Levels",n.append(a);const l=Object.keys(e).reduce((c,p)=>(c[p]={},c),{});for(const[c,p]of Object.entries(e)){const w=document.createElement("div");w.classList.add("level");const v=document.createElement("h3");v.classList.add("header-3"),v.classList.add("level__header"),v.textContent=c;const r=document.createElement("div");r.classList.add("level__frames");for(const[C,b]of Object.entries(p.frames)){const f=new y;f.element.classList.add("button"),f.element.classList.add("frame");const m=document.createElement("img");m.classList.add("frame__image"),m.src=ot,m.alt="Frame image";const E=document.createElement("h4");E.classList.add("header-3"),E.classList.add("frame__header"),E.textContent=C,f.element.append(m,E),r.append(f.element),l[c][C]=f}w.append(v,r),n.append(w)}return[s.element,l]}onPressFrameButton(e,s){this.emit("press",e,s)}}class lt extends B{constructor(t){super(),this.element=this.constructor.createElement(t)}static createElement(t,e=5){const s=new se,n=s.element.firstElementChild;n.classList.add("high-score");const a=document.createElement("table");a.classList.add("high-score-table");const l=document.createElement("caption");l.classList.add("header-2"),l.classList.add("high-score-table__caption"),l.textContent="High score table",a.append(l);const c=document.createElement("thead");c.classList.add("high-score-table__thead");const p=document.createElement("tr");p.classList.add("high-score-table__tr");const w=document.createElement("td");w.classList.add("high-score-table__td"),w.textContent="Name";const v=document.createElement("td");v.classList.add("high-score-table__td"),v.textContent="Difficulty";const r=document.createElement("td");r.classList.add("high-score-table__td"),r.textContent="Time",p.append(w,v,r),c.append(p),a.append(c);const C=[],b=JSON.parse(localStorage.getItem("completedGames"))??{};for(const[m,E]of Object.entries(b))for(const[ne,ae]of Object.entries(E))C.push({levelName:m,frameName:ne,frameSeconds:ae});C.sort((m,E)=>m.frameSeconds-E.frameSeconds);const f=document.createElement("tbody");f.classList.add("high-score-table__tbody");for(let m=0;m<Math.min(e,C.length);m+=1){const{levelName:E,frameName:ne,frameSeconds:ae}={...C[m]},oe=document.createElement("tr");oe.classList.add("high-score-table__tr");const ie=document.createElement("td");ie.classList.add("high-score-table__td"),ie.textContent=ne;const le=document.createElement("td");le.classList.add("high-score-table__td"),le.textContent=t[E].name;const re=document.createElement("td");re.classList.add("high-score-table__td"),re.textContent=ee.getFormattedTime(ae),oe.append(ie,le,re),f.append(oe)}return a.append(f),n.append(a),s.element}}class rt extends B{constructor(e,s){super();u(this,"controlPanel");u(this,"gameField");u(this,"solutionButton");u(this,"modalWindow");[this.element,this.controlPanel,this.gameField,this.solutionButton]=this.constructor.createElement(e,s),this.gameField.connect("game-win",this.onGameWin.bind(this)),this.gameField.connect("game-cell-changed",this.onGameCellChanged.bind(this)),this.controlPanel.soundButton.connect("press",this.onPressSoundButton.bind(this)),this.controlPanel.optionsButton.connect("press",this.onPressOptionsButton.bind(this)),this.solutionButton.connect("press",this.onPressSolutionButton.bind(this))}static createElement(e,s){const n=document.createElement("div");n.classList.add("wrapper");const a=document.createElement("div");a.classList.add("container");const l=new Ie,c=new O(e,s),p=new He;return a.append(l.element,c.element,p.element),n.append(a),[n,l,c,p]}onGameWin(){g.gameFinished=!0,this.controlPanel.gameTimer.stop(),this.gameField.switchGameCells(!1),this.gameField.updateContent(this.gameField.frame),this.solutionButton.element.disabled=!0;const e=new Be(this.controlPanel.gameTimer.seconds);document.body.append(e.element),g.muted||j.win.play();let s=JSON.parse(localStorage.getItem("completedGames"));s===null&&(s={}),Object.hasOwn(s,this.gameField.level.name.split(" ")[0])||(s[this.gameField.level.name.split(" ")[0]]={}),Object.hasOwn(s[this.gameField.level.name.split(" ")[0]],this.gameField.frame.name)?this.controlPanel.gameTimer.seconds<s[this.gameField.level.name.split(" ")[0]][this.gameField.frame.name]&&(s[this.gameField.level.name.split(" ")[0]][this.gameField.frame.name]=this.controlPanel.gameTimer.seconds):s[this.gameField.level.name.split(" ")[0]][this.gameField.frame.name]=this.controlPanel.gameTimer.seconds,localStorage.setItem("completedGames",JSON.stringify(s))}onGameCellChanged(){g.gameStarted||(g.gameStarted=!0,this.controlPanel.gameTimer.start())}onPressSoundButton(){g.muted=!this.controlPanel.soundButton.soundOn}onPressSolutionButton(){g.gameFinished=!0,this.controlPanel.gameTimer.stop(),this.gameField.switchGameCells(!1),this.gameField.updateContent(this.gameField.frame),this.solutionButton.element.disabled=!0}onPressOptionsButton(){this.modalWindow=new Ve,document.body.append(this.modalWindow.element),this.modalWindow.randomLevelButton.connect("press",this.onPressRandomLevelButton.bind(this)),this.modalWindow.resetGameButton.connect("press",this.onPressResetGameButton.bind(this)),this.modalWindow.levelsButton.connect("press",this.onPressLevelsButton.bind(this)),this.modalWindow.saveGameButton.connect("press",this.onPressSaveGameButton.bind(this)),this.modalWindow.continueLastGameButton.connect("press",this.onPressContinueLastGameButton.bind(this)),this.modalWindow.highScoreTableButton.connect("press",this.onPressHighScoreTableButton.bind(this))}onPressRandomLevelButton(){this.modalWindow.destroy();const e=at(),s=be(e);this.gameField=new O(e,s),document.body.querySelector(".game-field").replaceWith(this.gameField.element),this.gameField.connect("game-win",this.onGameWin.bind(this)),this.gameField.connect("game-cell-changed",this.onGameCellChanged.bind(this)),g.gameStarted=!1,g.gameFinished=!1,this.controlPanel.gameTimer.stop(),this.controlPanel.gameTimer.clear(),this.solutionButton.element.disabled=!1}onPressResetGameButton(){this.modalWindow.destroy(),this.gameField=new O(this.gameField.level,this.gameField.frame),document.body.querySelector(".game-field").replaceWith(this.gameField.element),this.gameField.connect("game-win",this.onGameWin.bind(this)),this.gameField.connect("game-cell-changed",this.onGameCellChanged.bind(this)),g.gameStarted=!1,g.gameFinished=!1,this.controlPanel.gameTimer.stop(),this.controlPanel.gameTimer.clear(),this.solutionButton.element.disabled=!1}onPressLevelsButton(){this.modalWindow.destroy(),this.modalWindow=new it(S),document.body.append(this.modalWindow.element),this.modalWindow.connect("press-frame-button",this.onPressFrameButton.bind(this))}onPressFrameButton(e,s){this.modalWindow.destroy(),this.gameField=new O(S[e],S[e].frames[s]),document.body.querySelector(".game-field").replaceWith(this.gameField.element),this.gameField.connect("game-win",this.onGameWin.bind(this)),this.gameField.connect("game-cell-changed",this.onGameCellChanged.bind(this)),g.gameStarted=!1,g.gameFinished=!1,this.controlPanel.gameTimer.stop(),this.controlPanel.gameTimer.clear(),this.solutionButton.element.disabled=!1}onPressSaveGameButton(){localStorage.setItem("lastGame",JSON.stringify({gameStarted:g.gameStarted,gameFinished:g.gameFinished,level:{name:this.gameField.level.name.split(" ")[0]},frame:{data:this.gameField.parseFrameData(),size:this.gameField.frame.width,name:this.gameField.frame.name},seconds:this.controlPanel.gameTimer.seconds}))}onPressContinueLastGameButton(){this.modalWindow.destroy();const e=JSON.parse(localStorage.getItem("lastGame"));g.gameStarted=e.gameStarted,g.gameFinished=e.gameFinished,this.controlPanel.gameTimer.stop(),e.gameStarted&&(this.controlPanel.gameTimer.setTime(e.seconds),e.gameFinished?this.solutionButton.disabled=!0:this.controlPanel.gameTimer.start()),this.gameField=new O(S[e.level.name],S[e.level.name].frames[e.frame.name]),document.body.querySelector(".game-field").replaceWith(this.gameField.element),this.gameField.updateContent(I.getFrameFromData(e.frame.data,e.frame.size,e.frame.name)),this.gameField.connect("game-win",this.onGameWin.bind(this)),this.gameField.connect("game-cell-changed",this.onGameCellChanged.bind(this))}onPressHighScoreTableButton(){this.modalWindow.destroy(),this.modalWindow=new lt(S),document.body.append(this.modalWindow.element)}}const Le=S.easy,ct=be(Le),dt=new rt(Le,ct);document.body.append(dt.element);
